<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Style AI - ë‚´ ìŠ¤íƒ€ì¼ ì°¾ê¸°</title>
    <!-- Tailwind CSS ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter í°íŠ¸ ì‚¬ìš© (Tailwind ê¸°ë³¸ í°íŠ¸ì™€ ìœ ì‚¬) */
        @import url('https://rsms.me/inter/inter.css');
        html { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <!-- w-full max-w-lg ì•ˆì— ë‘ ê°œì˜ ì¹´ë“œê°€ ë“¤ì–´ê°‘ë‹ˆë‹¤ -->
    <div class="w-full max-w-lg">
        <!-- í—¤ë” -->
        <header class="text-center mb-8">
            <h1 class="text-4xl font-extrabold text-gray-800">âœ¨ Style AI</h1>
            <p class="text-lg text-gray-600 mt-2">AIê°€ ë‹¹ì‹ ì˜ ìŠ¤íƒ€ì¼ì„ ì°¾ì•„ì¤ë‹ˆë‹¤.</p>
        </header>

        <!-- 
          =======================================
          [ê¸°ëŠ¥ 1] ìƒí™©ë³„ ì½”ë”” ìƒì„± ì¹´ë“œ
          (IDì— 'suggest-' ì ‘ë‘ì‚¬ ì¶”ê°€)
          =======================================
        -->
        <div class="bg-white rounded-xl shadow-xl overflow-hidden mb-8">
            <div class="p-6 md:p-8">
                <h2 class="text-xl font-bold text-gray-900">ğŸ¨ ìƒí™©ë³„ ì½”ë”” ìƒì„±</h2>
                
                <div class="mt-6">
                    <label for="situation-input" class="block text-sm font-medium text-gray-700 mb-2">ìƒí™©:</label>
                    <input 
                        type="text" 
                        id="situation-input"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg text-base text-gray-900 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                        placeholder="ì˜ˆ: ë¹„ ì˜¤ëŠ” ë‚  ì‹¤ë‚´ ë°ì´íŠ¸"
                        value="ë¹„ ì˜¤ëŠ” ë‚  ì‹¤ë‚´ ë°ì´íŠ¸"
                    >
                </div>

                <button 
                    id="suggest-button" 
                    class="w-full mt-6 bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg text-base shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors duration-200"
                >
                    ìŠ¤íƒ€ì¼ ì¶”ì²œë°›ê¸° ğŸš€
                </button>

                <div id="suggest-loading" class="hidden mt-6 text-center"> <!-- ID ë³€ê²½ -->
                    <svg class="animate-spin h-8 w-8 text-indigo-600 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <p class="mt-2 text-gray-600 font-medium">AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</p>
                </div>

                <div id="suggest-error" class="hidden mt-6 p-4 bg-red-100 border border-red-300 rounded-lg text-red-700"> <!-- ID ë³€ê²½ -->
                    <!-- ì˜¤ë¥˜ ë‚´ìš© -->
                </div>

                <div id="suggest-results" class="mt-8 space-y-4"> <!-- ID ë³€ê²½ -->
                    <!-- ì¶”ì²œ ê²°ê³¼ -->
                </div>
            </div>
        </div>

        <!-- 
          =======================================
          [ê¸°ëŠ¥ 2 - ì‹ ê·œ] ë‚˜ì˜ ìŠ¤íƒ€ì¼ ì°¾ê¸° ì¹´ë“œ
          =======================================
        -->
        <div class="bg-white rounded-xl shadow-xl overflow-hidden">
            <div class="p-6 md:p-8">
                <h2 class="text-xl font-bold text-gray-900">ğŸ” ë‚˜ì˜ ìŠ¤íƒ€ì¼ ì°¾ê¸°</h2>
                <p class="text-sm text-gray-500 mt-1">ê°„ë‹¨í•œ ì§ˆë¬¸ì— ë‹µí•˜ê³  ë‹¹ì‹ ì˜ ìŠ¤íƒ€ì¼ì„ ì°¾ì•„ë³´ì„¸ìš”.</p>
                
                <!-- ì§ˆë¬¸ 1 -->
                <div class="mt-6">
                    <label for="q1-input" class="block text-sm font-medium text-gray-700 mb-2">1. í‰ì†Œ ì¦ê²¨ ì…ëŠ” ì˜·ì€?</label>
                    <input 
                        type="text" 
                        id="q1-input"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg text-base text-gray-900 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                        placeholder="ì˜ˆ: í›„ë“œí‹°, ì²­ë°”ì§€, ì›í”¼ìŠ¤"
                        value="í¸ì•ˆí•œ í›„ë“œí‹°ì™€ ì¡°ê±°íŒ¬ì¸ "
                    >
                </div>

                <!-- ì§ˆë¬¸ 2 -->
                <div class="mt-4">
                    <label for="q2-input" class="block text-sm font-medium text-gray-700 mb-2">2. ì„ í˜¸í•˜ëŠ” ìƒ‰ìƒì€?</label>
                    <input 
                        type="text" 
                        id="q2-input"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg text-base text-gray-900 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                        placeholder="ì˜ˆ: ê²€ì •, í°ìƒ‰, íŒŒìŠ¤í…”í†¤"
                        value="ê²€ì •, íšŒìƒ‰ ë“± ë¬´ì±„ìƒ‰"
                    >
                </div>

                <!-- ì§ˆë¬¸ 3 -->
                <div class="mt-4">
                    <label for="q3-input" class="block text-sm font-medium text-gray-700 mb-2">3. ìì£¼ ê°€ëŠ” ì¥ì†ŒëŠ”?</label>
                    <input 
                        type="text" 
                        id="q3-input"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg text-base text-gray-900 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                        placeholder="ì˜ˆ: í•™êµ, íšŒì‚¬, ì¹´í˜, í—¬ìŠ¤ì¥"
                        value="ì§‘ ê·¼ì²˜ ì¹´í˜, ê³µì› ì‚°ì±…"
                    >
                </div>

                <button 
                    id="find-style-button"
                    class="w-full mt-6 bg-green-600 text-white font-bold py-3 px-4 rounded-lg text-base shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200"
                >
                    ë‚´ ìŠ¤íƒ€ì¼ ë¶„ì„í•˜ê¸° âœ¨
                </button>

                <div id="find-style-loading" class="hidden mt-6 text-center">
                    <svg class="animate-spin h-8 w-8 text-green-600 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <p class="mt-2 text-gray-600 font-medium">AIê°€ ìŠ¤íƒ€ì¼ì„ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</p>
                </div>

                <div id="find-style-error" class="hidden mt-6 p-4 bg-red-100 border border-red-300 rounded-lg text-red-700">
                    <!-- ì˜¤ë¥˜ ë‚´ìš© -->
                </div>

                <!-- [ì‹ ê·œ] ìŠ¤íƒ€ì¼ ë¶„ì„ ê²°ê³¼ -->
                <div id="find-style-result" class="hidden mt-8 p-5 border border-green-300 rounded-lg bg-green-50 shadow-sm">
                    <!-- ìŠ¤íƒ€ì¼ ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— ì‚½ì…ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <script>
    // --- ë°±ì—”ë“œ API ì£¼ì†Œ ---
    const API_BASE_URL = 'https://styleai-backend-zr77.onrender.com/'; 



        // ===========================================
        // [ê¸°ëŠ¥ 1] ìƒí™©ë³„ ì½”ë”” ì¶”ì²œ (ID ë³€ê²½ ì ìš©)
        // ===========================================
        const situationInput = document.getElementById('situation-input');
        const suggestButton = document.getElementById('suggest-button'); // ID ë³€ê²½
        const suggestLoading = document.getElementById('suggest-loading'); // ID ë³€ê²½
        const suggestError = document.getElementById('suggest-error'); // ID ë³€ê²½
        const suggestResults = document.getElementById('suggest-results'); // ID ë³€ê²½

        suggestButton.addEventListener('click', async () => {
            const situation = situationInput.value.trim();
            if (!situation) {
                showError("ìƒí™©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.", suggestError); // ì—ëŸ¬ í‘œì‹œ í•¨ìˆ˜ì— ëŒ€ìƒ ì „ë‹¬
                return;
            }

            // UI ì´ˆê¸°í™”
            suggestButton.disabled = true;
            suggestButton.classList.add('opacity-50', 'cursor-not-allowed');
            suggestLoading.classList.remove('hidden');
            suggestError.classList.add('hidden');
            suggestResults.innerHTML = '';

            try {
                const response = await fetch(`${API_BASE_URL}/api/suggest-style`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ situation: situation }),
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `ì„œë²„ ì˜¤ë¥˜ (${response.status})`);
                }

                const result = await response.json(); 
                displaySuggestResults(result.recommendations);

            } catch (err) {
                console.error("API 1 í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜:", err);
                showError(`ìš”ì²­ ì‹¤íŒ¨: ${err.message}`, suggestError); // ì—ëŸ¬ í‘œì‹œ í•¨ìˆ˜ì— ëŒ€ìƒ ì „ë‹¬
            } finally {
                suggestLoading.classList.add('hidden');
                suggestButton.disabled = false;
                suggestButton.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        });

        // [ê¸°ëŠ¥ 1] ê²°ê³¼ ë Œë”ë§ í•¨ìˆ˜
        function displaySuggestResults(recommendations) {
            if (!recommendations || recommendations.length === 0) {
                showError("ì¶”ì²œì„ ìƒì„±í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.", suggestError);
                return;
            }
            recommendations.forEach(rec => {
                const itemsHtml = rec.items
                    .map(item => `<li class="text-gray-600">â€¢ ${item}</li>`)
                    .join('');
                const recommendationHtml = `
                    <div class="p-5 border border-gray-200 rounded-lg bg-gray-50 shadow-sm">
                        <h3 class="text-lg font-semibold text-indigo-800">${rec.style_name}</h3>
                        <div class="h-px bg-gray-300 my-2"></div>
                        <ul class="mt-3 ml-1 space-y-1 list-inside">
                            ${itemsHtml}
                        </ul>
                    </div>
                `;
                suggestResults.innerHTML += recommendationHtml;
            });
        }

        // ===========================================
        // [ê¸°ëŠ¥ 2 - ì‹ ê·œ] ë‚˜ì˜ ìŠ¤íƒ€ì¼ ì°¾ê¸°
        // ===========================================
        const q1Input = document.getElementById('q1-input');
        const q2Input = document.getElementById('q2-input');
        const q3Input = document.getElementById('q3-input');
        const findStyleButton = document.getElementById('find-style-button');
        const findStyleLoading = document.getElementById('find-style-loading');
        const findStyleError = document.getElementById('find-style-error');
        const findStyleResult = document.getElementById('find-style-result');

        findStyleButton.addEventListener('click', async () => {
            const q1_clothes = q1Input.value.trim();
            const q2_colors = q2Input.value.trim();
            const q3_places = q3Input.value.trim();

            if (!q1_clothes || !q2_colors || !q3_places) {
                showError("ëª¨ë“  ì§ˆë¬¸ì— ë‹µí•´ì£¼ì„¸ìš”.", findStyleError);
                return;
            }

            // UI ì´ˆê¸°í™”
            findStyleButton.disabled = true;
            findStyleButton.classList.add('opacity-50', 'cursor-not-allowed');
            findStyleLoading.classList.remove('hidden');
            findStyleError.classList.add('hidden');
            findStyleResult.classList.add('hidden');
            findStyleResult.innerHTML = '';

            try {
                const response = await fetch(`${API_BASE_URL}/api/find-style`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ 
                        q1_clothes: q1_clothes,
                        q2_colors: q2_colors,
                        q3_places: q3_places
                    }),
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `ì„œë²„ ì˜¤ë¥˜ (${response.status})`);
                }

                const result = await response.json(); 
                displayFindStyleResult(result);

            } catch (err) {
                console.error("API 2 í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜:", err);
                showError(`ìš”ì²­ ì‹¤íŒ¨: ${err.message}`, findStyleError);
            } finally {
                findStyleLoading.classList.add('hidden');
                findStyleButton.disabled = false;
                findStyleButton.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        });

        // [ê¸°ëŠ¥ 2] ê²°ê³¼ ë Œë”ë§ í•¨ìˆ˜
        function displayFindStyleResult(result) {
            if (!result || !result.style_name) {
                showError("ìŠ¤íƒ€ì¼ì„ ë¶„ì„í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.", findStyleError);
                return;
            }

            const resultHtml = `
                <h3 class="text-lg font-semibold text-green-800">ë‹¹ì‹ ì˜ ìŠ¤íƒ€ì¼ì€: <span class="font-extrabold">${result.style_name}</span></h3>
                <p class="text-gray-700 mt-2">${result.description}</p>
            `;
            
            findStyleResult.innerHTML = resultHtml;
            findStyleResult.classList.remove('hidden');
        }

        // --- ê³µí†µ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜ ---
        // (ì´ì œ 'targetElement'ë¥¼ ë°›ì•„ì„œ í•´ë‹¹ ìœ„ì¹˜ì— ì˜¤ë¥˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤)
        function showError(message, targetElement) {
            targetElement.textContent = message;
            targetElement.classList.remove('hidden');
        }

    </script>
</body>

</html>
